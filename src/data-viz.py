# hopefully this maps the facial landmarks of a real participant to the dummy face
# high level steps:

import numpy as np
import csv
import sys
import matplotlib.pyplot as plt

"""
sample data:
frame, timestamp, confidence, success, X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X17, X18, X19, X20, X21, X22, X23, X24, X25, X26, X27, X28, X29, X30, X31, X32, X33, X34, X35, X36, X37, X38, X39, X40, X41, X42, X43, X44, X45, X46, X47, X48, X49, X50, X51, X52, X53, X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, Y8, Y9, Y10, Y11, Y12, Y13, Y14, Y15, Y16, Y17, Y18, Y19, Y20, Y21, Y22, Y23, Y24, Y25, Y26, Y27, Y28, Y29, Y30, Y31, Y32, Y33, Y34, Y35, Y36, Y37, Y38, Y39, Y40, Y41, Y42, Y43, Y44, Y45, Y46, Y47, Y48, Y49, Y50, Y51, Y52, Y53, Y54, Y55, Y56, Y57, Y58, Y59, Y60, Y61, Y62, Y63, Y64, Y65, Y66, Y67, Z0, Z1, Z2, Z3, Z4, Z5, Z6, Z7, Z8, Z9, Z10, Z11, Z12, Z13, Z14, Z15, Z16, Z17, Z18, Z19, Z20, Z21, Z22, Z23, Z24, Z25, Z26, Z27, Z28, Z29, Z30, Z31, Z32, Z33, Z34, Z35, Z36, Z37, Z38, Z39, Z40, Z41, Z42, Z43, Z44, Z45, Z46, Z47, Z48, Z49, Z50, Z51, Z52, Z53, Z54, Z55, Z56, Z57, Z58, Z59, Z60, Z61, Z62, Z63, Z64, Z65, Z66, Z67
1, 0, 0.939744, 1, -7.52669, -5.39618, -1.06013, 4.80662, 14.6816, 28.572, 43.5552, 59.0382, 75.6361, 91.8907, 107.57, 122.305, 133.791, 140.411, 143.376, 144.569, 144.392, 4.44732, 13.9521, 27.1431, 40.5882, 52.7579, 75.7837, 88.0743, 101.428, 115.114, 125.795, 66.5981, 67.2318, 67.8987, 68.6245, 55.5909, 62.879, 70.1438, 77.4991, 84.2687, 22.1209, 29.9966, 39.5663, 48.1613, 39.7992, 30.1118, 84.6645, 92.4948, 102.262, 111.125, 103.476, 93.8297, 46.3701, 56.3278, 65.2877, 72.1675, 79.3808, 89.3342, 99.9264, 90.9112, 82.0209, 74.1325, 66.8105, 57.1902, 50.8615, 66.0466, 72.8762, 80.4004, 95.1112, 80.703, 73.1829, 66.2502, 0.713715, 22.4014, 44.2685, 64.9567, 82.693, 96.273, 105.483, 111.764, 113.196, 111.515, 104.294, 93.59, 78.8169, 60.3372, 39.5488, 18.2211, -2.76381, -13.4846, -21.5719, -23.4303, -21.0614, -15.8564, -16.9117, -23.335, -26.7804, -26.5521, -20.2282, 0.63455, 12.4366, 23.6957, 35.1831, 46.0603, 47.6937, 49.0163, 46.7489, 44.0732, 3.28431, -0.633938, -0.733376, 4.30473, 6.73451, 7.19393, 2.48788, -3.81735, -4.41099, -1.27741, 3.08733, 4.027, 73.4567, 67.9241, 64.4119, 65.8496, 63.657, 66.0693, 69.3876, 76.9661, 80.9033, 82.1732, 82.1308, 79.9209, 73.2667, 70.8128, 70.9481, 69.7856, 70.0867, 71.4699, 72.6746, 72.5547, 614.652, 618.644, 623.342, 626.856, 624.15, 617.385, 606.321, 595.694, 593.633, 600.863, 615.076, 627.248, 630.953, 629.736, 626.35, 623.376, 622.597, 577.667, 569.126, 561.514, 555.138, 551.279, 552.348, 558.557, 566.784, 575.952, 585.887, 558.704, 553.39, 547.559, 542.13, 561.307, 558.846, 557, 559.21, 562.213, 575.604, 570.323, 569.259, 570.621, 570.369, 571.139, 572.621, 573.841, 576.249, 582.06, 576.795, 574.287, 580.054, 567.233, 562.201, 562.305, 563.426, 571.298, 585.187, 574.156, 567.692, 566.052, 566.219, 571.111, 577.231, 565.848, 565.408, 567.131, 581.638, 567.067, 565.3, 565.966
"""


    # print(f'exiting now...')
    # sys.exit()


def plot_3D(landmarks: np.ndarray):
    fig = plt.figure()
    ax = fig.add_subplot(projection='3d')
    ax.view_init(elev=-90, azim=-90, roll=0)

    xs, ys, zs = landmarks[:,0], landmarks[:,1], landmarks[:,2]

    ax.scatter(xs, ys, zs)
    ax.set(xticklabels=[],
       yticklabels=[],
       zticklabels=[])
    plt.title('3D facial landmarks')
    plt.show()


def flame_vis(landmarks: np.ndarray):
    pass


if __name__ == "__main__":
    print(f'running align-faces...')
    landmarks_A = extract_landmarks("../data/300_P/300_CLNF_features3D.txt")
    # print(f'dims: {landmarks_A.shape} \n{landmarks_A}')
    plot_3D(landmarks_A)

    # landmarks_B = extract_landmarks("../../processed/dummy_face_aligned")
    

    